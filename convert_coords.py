"""
Модуль для конвертации координат bounding boxes из пикселей в проценты.

Этот скрипт преобразует абсолютные координаты bounding boxes (в пикселях)
в относительные координаты в процентах от размера изображения, используя
единицы измерения viewport width (vw) и viewport height (vh).

Использование:
    python convert_coords.py

Выходные данные:
    Выводит в консоль преобразованные координаты для каждого объекта
    в формате CSS-подобных единиц (vw, vh).
"""

# Координаты объектов из терминала (строки 391-565)
# Формат: [id, bbox] где bbox = [x1, y1, x2, y2] в пикселях
objects = [
    {"id": 0, "bbox": [194, 1779, 388, 1889]},
    {"id": 1, "bbox": [26, 1963, 90, 2352]},
    {"id": 2, "bbox": [11, 900, 79, 1315]},
    {"id": 3, "bbox": [65, 374, 168, 718]},
    {"id": 4, "bbox": [55, 2339, 165, 2529]},
    {"id": 5, "bbox": [157, 674, 219, 827]},
    {"id": 6, "bbox": [11, 1494, 173, 1628]},
    {"id": 7, "bbox": [98, 1161, 176, 1529]},
    {"id": 8, "bbox": [204, 940, 388, 1279]},
    {"id": 9, "bbox": [187, 2041, 260, 2261]},
    {"id": 10, "bbox": [148, 2362, 309, 2472]},
    {"id": 11, "bbox": [192, 1541, 326, 1681]},
    {"id": 12, "bbox": [78, 1847, 262, 2102]},
    {"id": 13, "bbox": [42, 67, 98, 472]},
    {"id": 14, "bbox": [117, 104, 296, 379]},
    {"id": 15, "bbox": [327, 270, 370, 691]},
    {"id": 16, "bbox": [218, 1346, 314, 1571]},
    {"id": 17, "bbox": [222, 259, 259, 683]},
    {"id": 18, "bbox": [70, 1587, 117, 1682]},
    {"id": 19, "bbox": [155, 420, 227, 556]},
    {"id": 20, "bbox": [244, 861, 293, 975]},
    {"id": 21, "bbox": [168, 516, 221, 674]},
]

# Определяем размер изображения из максимальных координат
# Используем максимальные значения x2 и y2 (правый нижний угол) как базовые размеры
max_x = max([obj["bbox"][2] for obj in objects])  # Максимальная координата x2
max_y = max([obj["bbox"][3] for obj in objects])  # Максимальная координата y2

# Добавляем небольшой запас для полного размера изображения
# Это необходимо, так как координаты могут не доходить до края изображения
img_width = max_x + 12  # примерно 400 пикселей
img_height = max_y + 71  # примерно 2600 пикселей

# Вывод информации о размере изображения
print(f"Image size: {img_width}x{img_height}")
print("\nConverted coordinates:")

# Конвертация координат каждого объекта из пикселей в проценты
for obj in objects:
    # Извлечение координат bounding box
    x1, y1, x2, y2 = obj["bbox"]
    
    # Преобразование в проценты от размера изображения
    # left и top - позиция левого верхнего угла
    left = (x1 / img_width) * 100
    top = (y1 / img_height) * 100
    
    # width и height - размеры bounding box
    width = ((x2 - x1) / img_width) * 100
    height = ((y2 - y1) / img_height) * 100
    
    # Вывод преобразованных координат в формате CSS viewport units
    print(f"Object {obj['id']}: left={left:.1f}vw, top={top:.1f}vh, width={width:.1f}vw, height={height:.1f}vh")
